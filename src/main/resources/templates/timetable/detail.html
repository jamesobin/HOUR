<!DOCTYPE html>
<html lang="ko" 
    xmlns:th="http://www.thymeleaf.org" 
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/include-timetable}">
    
		<section layout:fragment="contents" class="contents d-flex mt-4">
			<aside class="side-menu col-2">
				<select id="timetableSelect">
					<option selected>시간표 선택</option>
				    <option></option>
				</select>
				<div class="timetable-info border border-dark mt-3 d-flex align-items-center p-2">
					<div>
						<div>시간표 이름</div>
						<div class="mt-3">18학점</div>
					</div>
				</div>
				<button type="button" class="btn btn-block btn-dark mt-3" onclick = "location.href='/timetable/input-view'">+새 시간표 만들기</button>
				<button type="button" class="btn btn-block btn-dark" onclick = "location.href='/timetable/lecture/input-view'">시간표 수정</button>
				<button type="button" class="btn btn-block btn-dark" id="deleteBtn">시간표 삭제</button>
			</aside>
			<div class="main-contents col-10">
				<table id="time-table">
					<thead>
						<tr>
							<th></th>
							<th>월</th>
							<th>화</th>
							<th>수</th>
							<th>목</th>
							<th>금</th>
						</tr>
					</thead>
					<tbody>
						<th:block th:each="timetable:${tableList}">
							<th:block th:each="period:${timetable.periodDTOList}">
								<tr>
									<th th:text="${period.period}">1교시</th>
									<th:block th:each="lecture:${period.lectureList}">
										<td>
											<th:block th:if="${lecture} == null">
												<div></div>
											</th:block>
											<th:block th:unless="${lecture} == null">
												<div th:text="${lecture.lectureName}" class="font-weight-bold">강의명</div>
												<div class="d-flex align-items-end">
													<div th:text="${lecture.professorName}" class="font-weight-bold">교수명</div>
													<div th:text="${lecture.classRoom}" class="small-text ml-2">강의실</div>
												</div>
											</th:block>
										</td>
									</th:block>
								</tr>
							</th:block>
						</th:block>
					</tbody>
				</table>
			</div>
		</section>
	<script layout:fragment="script">
		$(document).ready(function() {
			$("#deleteBtn").on("click", function() {
				let id = $("#timetableSelect option:selected").val();
				
				$.ajax({
					type:"delete"
					, url:"/timetable/delete"
					, data:{"id":id}
					, success:function(response) {
						if(response.result == "success") {
							location.href="/timetable/detail-view";
						} else {
							alert("삭제 실패!");
						}
					}
					, error:function() {
						alert("삭제 에러!");
					}
				});
			});
		});
	</script>
</body>
</html>