<!DOCTYPE html>
<html lang="ko" 
    xmlns:th="http://www.thymeleaf.org" 
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/default}">
    
		<section layout:fragment="contents" class="contents d-flex mt-4">
			<aside class="side-menu col-2">
				<select id="timetableSelect">
				    <th:block th:each="timetable:${timetableList}">
				        <option th:value="${timetable.id}" th:text="${timetable.timetableName}">2018년도 1학기</option>
				    </th:block>
				</select>
				<div class="timetable-info border border-dark mt-3 d-flex align-items-center p-2">
					<div>
						<div id="timetable">시간표 이름</div>
						<div class="mt-3">18학점</div>
					</div>
				</div>
				<button type="button" class="btn btn-block btn-dark mt-3" id="addLectureBtn">수업 추가</button>
				<div class="input-menu border border-dark mt-3 p-2">
					<div class="text-center"><h4 class="font-weight-bold">새 수업 추가</h4></div>
					<label class="mt-2">강의명</label><input type="text" class="form-control" id="lectureNameInput">
					<label class="mt-2">교수명</label><input type="text" class="form-control" id="professorNameInput">
					<label class="mt-2">이수 학점</label>
					<select id="creditInput">
						<option selected></option>
						<option value="0">0</option>
						<option value="1">1</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5</option>
						<option value="6">6</option>
						<option value="7">7</option>
						<option value="8">8</option>
						<option value="9">9</option>
					</select>
					<label class="mt-2">시간/장소</label>
					<div class="border border-dark p-2">
						<div class="d-flex justify-content-between">
							<input type="radio" class="day-btn d-none" id="mon-btn" autocomplete="off" name="day" value="월">
							<label class="btn btn-sm btn-secondary" for="mon-btn">월</label>
							<input type="radio" class="day-btn d-none" id="tue-btn" autocomplete="off" name="day" value="화">
							<label class="btn btn-sm btn-secondary" for="tue-btn">화</label>
							<input type="radio" class="day-btn d-none" id="wed-btn" autocomplete="off" name="day" value="수">
							<label class="btn btn-sm btn-secondary" for="wed-btn">수</label>
							<input type="radio" class="day-btn d-none" id="thu-btn" autocomplete="off" name="day" value="목">
							<label class="btn btn-sm btn-secondary" for="thu-btn">목</label>
							<input type="radio" class="day-btn d-none" id="fri-btn" autocomplete="off" name="day" value="금">
							<label class="btn btn-sm btn-secondary" for="fri-btn">금</label>
						</div>
						<div class="mt-2 d-flex align-items-end">
							<label class="w-100">수업 시작</label><input type='time' class="form-control" id="startTimeInput">
						</div>
						<div class="mt-2 d-flex align-items-end">
							<label class="w-100">수업 종료</label><input type='time' class="form-control" id="endTimeInput">
						</div>
						<div class="mt-2">
							<div>수업 장소</div>
							<input type="text" class="form-control mt-2" id="classRoomInput">
						</div>
					</div>
				</div>
			</aside>
			<div class="main-contents col-10 d-flex justify-content-center">
				<table border="1" width="1300px">
					<thead>
						<tr>
							<th width="100px"></th>
							<th>월</th>
							<th>화</th>
							<th>수</th>
							<th>목</th>
							<th>금</th>
						</tr>
					</thead>
					<tbody height="640px">
						<tr>
							<th>1교시</th>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
						<tr>
							<th>2교시</th>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
						<tr>
							<th>3교시</th>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
						<tr>
							<th>4교시</th>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
						<tr>
							<th>5교시</th>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
						<tr>
							<th>6교시</th>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
						<tr>
							<th>7교시</th>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
						<tr>
							<th>8교시</th>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
					</tbody>
				</table>
			</div>
		</section>
		
	<script layout:fragment="script">
		$(document).ready(function() {
			$("#timetableSelect").on("click", function() {
				let timetable = $("#timetableSelect option:selected").text();
				
				$("#timetable").text(timetable);
			});
			
			$("#addLectureBtn").on("click", function() {
				let timetableId = $("#timetableSelect option:selected").val();
				let lectureName = $("#lectureNameInput").val();
				let professorName = $("#professorNameInput").val();
				let credit = $("#creditInput option:selected").val();
				let day = $("input[name='day']:checked").val();
				let startTime = $("#startTimeInput").val();
				let endTime = $("#endTimeInput").val();
				let classRoom = $("#classRoomInput").val();
				
				if(timetable == "시간표 선택") {
					alert("시간표를 선택하세요");
					return;
				}
				if(lectureName == "") {
					alert("강의명을 입력하세요");
					return;
				}
				if(professorName == "") {
					alert("교수명을 입력하세요");
					return;
				}
				if(credit == "") {
					alert("이수 학점을 선택하세요");
					return;
				}
				if(day == null) {
					alert("요일을 선택하세요");
					return;
				}
				if(startTime == "") {
					alert("수업 시작 시간을 입력하세요");
					return;
				}
				if(endTime == "") {
					alert("수업 종료 시간을 입력하세요");
					return;
				}
				if(classRoom == "") {
					alert("강의실을 입력하세요");
					return;
				}
				
				let formData = new FormData();
				
				formData.append("timetableId", timetableId);
				formData.append("lectureName", lectureName);
				formData.append("professorName", professorName);
				formData.append("credit", credit);
				formData.append("day", day);
				formData.append("startTime", startTime);
				formData.append("endTime", endTime);
				formData.append("classRoom", classRoom);
				
				$.ajax({
					type:"post"
					, url:"/lecture/create"
					, data:formData
					, enctype:"multipart/form-data"
					, processData:false
					, contentType:false
					, success:function(response) {
						if(response.result == "success") {
							location.href = "/timetable/lecture/input-view";
						} else {
							alert("수업 추가 실패!");
						}
					}
					, error:function() {
						alert("수업 추가 에러!");
					}
				});
			});
		});
	</script>
</body>
</html>