<!DOCTYPE html>
<html lang="ko" 
    xmlns:th="http://www.thymeleaf.org" 
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/default}">
    
		<section layout:fragment="contents" class="contents d-flex mt-4">
			<aside class="side-menu col-2">
				<button type="button" class="btn btn-block btn-dark" onclick = "location.href='/grade/entire-view'">전체 성적 조회</button>
				<button type="button" class="btn btn-block btn-dark" onclick = "location.href='/grade/specific-view'">세부 성적 조회</button>
				<button type="button" class="btn btn-block btn-dark" onclick = "location.href='/grade/input-view'">성적 입력</button>
			</aside>
			<div class="main-contents col-10 px-5">
				<div class="grade-info-box border border-dark d-flex align-items-center">
					<div id="curve_chart" style="width:1200px; height:300px;"></div>
					<div>
						<h5 class="font-weight-bold">전체 평점</h5>
						<div class="d-flex justify-content-end align-items-end">
							<h4 class="text-danger">3.5</h4>
							<h5>/4.3</h5>
						</div>
						<h5 class="font-weight-bold mt-5">취득 학점</h5>
						<div class="d-flex justify-content-end align-items-end">
							<h4 class="text-danger">128</h4>
							<h5>/130</h5>
						</div>
					</div>
				</div>
				<div class="grade-input-box p-4 mt-3 d-flex justify-content-center">
					<div class="border border-dark p-3">
						<div>시간표 선택</div>
						<select id="timetableSelect" class="col-5 mt-2">
							<option th:selected="${selectedId == null}" value="">시간표 선택</option>
							<th:block th:each="timetable:${allTimetableList}">
								<option th:value="${timetable.id}" th:text="${timetable.timetableName}" th:selected="${selectedId == timetable.id}">시간표 이름</option>
							</th:block>
						</select>
						<div class="d-flex justify-content-between mt-2">
							<div class="d-flex align-items-end">
								<div class="mt-2">학기 :</div>
								<div class="term-box ml-2">1학년 1학기</div>
							</div>
							<button type="button" class="btn btn-block btn-dark btn-sm col-2">저장</button>
						</div>
						<div>
							<table border="1" class="grade-input-table mt-3 text-center">
								<thead>
									<tr>
										<th width="500">수업명</th>
										<th width="100">학점</th>
										<th width="100">성적</th>
									</tr>
								</thead>
								<tbody>
									<th:block th:if="${param.id[0] != null}">
										<tr th:each="lecture:${creditList}">
											<td th:text="${lecture.lectureName}">건축공학개론</td>
											<td th:text="${lecture.credit}">3</td>
											<td>
												<select class="border-0">
													<option value=null>-</option>
													<option value="4.3">A+</option>
													<option value="4.0">A0</option>
													<option value="3.7">A-</option>
													<option value="3.3">B+</option>
													<option value="3.0">B0</option>
													<option value="2.7">B-</option>
													<option value="2.3">C+</option>
													<option value="2.0">C0</option>
													<option value="1.7">C-</option>
													<option value="1.3">D+</option>
													<option value="1.0">D0</option>
													<option value="0.7">D-</option>
													<option value="0">F</option>
												</select>
											</td>
										</tr>
									</th:block>
									<th:block th:unless="${param.id[0] != null}">
										<tr th:each="i:${#numbers.sequence(1, 7)}">
											<td></td>
											<td></td>
											<td></td>
										</tr>
									</th:block>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</section>
		
		<th:block layout:fragment="library">
			<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
			<script type="text/javascript">
				google.charts.load('current', {packages: ['corechart']});
				google.charts.setOnLoadCallback(drawChart);
				
				// 차트 그리기 함수
				function drawChart() {
				  const data1 = google.visualization.arrayToDataTable([
				    ['term', 'grade', { role: 'style' }],
				    ['1학년 1학기',  2.5, 'point {fill-color: white; stroke-color: red; stroke-width: 2}'],
				    ['1학년 2학기',  2.6, 'point {fill-color: white; stroke-color: red; stroke-width: 2}'],
				    ['2학년 1학기',  3.2, 'point {fill-color: white; stroke-color: red; stroke-width: 2}'],
				    ['2학년 2학기',  3.1, 'point {fill-color: white; stroke-color: red; stroke-width: 2}'],
				    ['3학년 1학기',  4.0, 'point {fill-color: white; stroke-color: red; stroke-width: 2}'],
				    ['3학년 2학기',  3.8, 'point {fill-color: white; stroke-color: red; stroke-width: 2}'],
				    ['4학년 1학기',  3.8, 'point {fill-color: white; stroke-color: red; stroke-width: 2}'],
				    ['4학년 2학기',  4.1, 'point {fill-color: white; stroke-color: red; stroke-width: 2}'],
				    ['5학년 1학기',  3.6, 'point {fill-color: white; stroke-color: red; stroke-width: 2}'],
				    ['5학년 2학기',  , 'point {fill-color: white; stroke-color: red; stroke-width: 2}'],
				  ]);
				
				  const options1 = {
				    chartArea: { left: 70, top: 50, width: '90%', height: '70%' },
				    legend: { position: 'none' },
				    series: { 0: { color: 'red' } },
				    pointSize: 10,
				    vAxis: {
						viewWindow: {min: 2.0, max: 4.5},
						gridlines: { count: 5 }
					},
				    pointSize: 7 // 포인트 크기
				  };
				
				  const chart1 = new google.visualization.LineChart(document.getElementById('curve_chart'));
				  chart1.draw(data1, options1);
				}
			</script>
		</th:block>
		
		<script layout:fragment="script">
			$(document).ready(function() {
				$("#timetableSelect").on("change", function() {
					let id = $("#timetableSelect option:selected").val();
					
					if(id == "") {
						location.href="/grade/input-view";
					} else {
						location.href="/grade/input/timetable-view?id=" + id;
					}
				});
			});
		</script>